use master;
GO
DROP DATABASE BINAES;
--******************************************************* DATA BASE CREATION ******************************************************
CREATE DATABASE BINAES;
GO
USE BINAES;
GO
--******************************************************* TABLE'S CREATION ******************************************************
CREATE TABLE CELEBRATION(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    --ATRIBUTOS
    title VARCHAR(150) NOT NULL,
    picture VARBINARY(MAX)
        DEFAULT 0xFFD8FFE000104A46494600010101006000600000FFE1003A4578696600004D4D002A00000008000351100001000000010100000051110004000000010000000051120004000000010000000000000000FFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F141D1A1F1E1D1A1C1C20242E2720222C231C1C2837292C30313434341F27393D38323C2E333432FFDB0043010909090C0B0C180D0D1832211C213232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232FFC000110800E600DB03012200021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00F7BA28A298828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A293728EA45002D14DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A00751451400514514005145140055693FD637D6ACF6AACFF00EB1BEB400DA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802D2FDD14B48BF7696800A28A2800A28A2800ED559FF00D637D6ACF6AACFFEB1BEB400DA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802D2FDDA5A45FBB4B400514514005145140076AACFF00EB1BEB567B5567FF0058DF5A006D1451400514514005145140051451400514514005145140051451400514514005145140051451401697EED2D22FDDA5A0028A28A0028A28A003B5567FF58DF5AB3DAAB3FF00AC6FAD00368A28A0028A28A0028C13D01A2B9A4B36D6758D484F7D791ADBCAB1C6904BB401B73E9401D361BD0FE546D6F43F95617FC23307FD04753FFC09FF00EB51FF0008CC1FF411D4FF00F027FF00AD401BBB5BD0FE546D6F43F95617FC23307FD04753FF00C09FFEB51FF08CC1FF00411D4FFF00027FFAD401BBB5BD0FE546D6F43F95617FC23307FD04753FFC09FF00EB51FF0008CC1FF411D4FF00F027FF00AD401BBB5BD0FE54983DC1FCAB0FFE11983FE823A9FF00E04FFF005AA9EABA30D374BB8BDB7D4751F3A04DE9BE7C8C8F518A623A8A2A3B77325BC4EDF7990138F5C54948614514500145145005A5FBB4B48BF7696800A28A2800A28A2800ED559FFD637D6ACF6AACFF00EB1BEB400DA28A2800A28A2800AC4D1BFE431ADFFD7C2FFE822B6EB1346FF90C6B7FF5F0BFFA08A00DBA28A2800A28A280395D6BC61FD9DA8BDA5B5B2CA622048CEC473DC0C7F3ADCD23538F57D3A3BB8D4A672194FF00091585ADF838EA3A8BDE5B5C2446539915D49E7D456EE91A647A4E9D1DA46C5F6E4B311F789EA69E82D6E5EACAF127FC8BB7FF00F5C8D6AD657893FE45DBFF00FAE4692197ED3FE3CADFFEB92FF215354369FF001E56FF00F5C97F90A9A800A28A2800A28A2802D2FDDA5A45FBB4B400514514005145140076AACFFEB1BEB567B5567FF58DF5A006D14514005145140056268DFF00218D6FFEBE17FF004115B7585A548916A7AEC92BAA4693A966638006C1CD006DC922431349230545196627802BCEF5FF0014DC5FDD2A58C8F0DB42DB9594E19D8773EDE829BE23F123EAD21B7B62C966A78EC643EA7DBDAB9EAA4896CF4AF0E788D35887C99B6A5E20CB28E8E3FBC3FA8ADFAF198A5920952689D92443B9594F20D7A47873C471EB10F933154BC41F32F40E3D47F5149A1A66F5676AFACDAE8D6C25B8259D8E1225FBCDFE7D69359D66DF46B4F36521A46E23881E5CFF0087BD798DFDFDC6A576F7372FB9DBA0ECA3D07B5090367ACDA5E417F6C9716D20789C6411FC8FBD51F127FC8B97DFF5C8D701A1EB93E8B75B941781CFEF22CF5F71E86BB8D62EE0BFF095E5CDB482489E13823F507D08A2D60BDD1AD69FF1E56FFF005C97F90A9AA1B4FF008F383FEB92FF002A9A90C28A28A0028A28A00B4BF7696917EED2D0014514500145145001DAAB3FFAC6FAD59ED559FF00D637D6801B45145001451450015E63E23BA99757D46D55CAC2F307751FC44018CD7A7572BAB7837FB475296EE2BD1179BCB2326707DA9A13380A2BB1FF0084025FFA08C7FF007E8FF8D1FF000804DFF4118FFEFD1FF1AABA1599C753E296482649A1764910E5594F20D75DFF000804DFF4118FFEFD1FF1A3FE1009BFE8231FFDFA3FE345D0599CB5F5F5CEA576D7377299242319EC07A01D8557AEC7FE1009BFE8231FFDFA3FE347FC20137FD0463FFBF47FC68BA0B338EAB36FA85C5ADADCDB23FEE2E136C887A7D7EB5D47FC20137FD0463FFBF47FC6957C00FB86FD4536E79DB11CE3F3A2E82CCEC6CFFE3CADFF00EB92FF0021535363458E3545FBAA028CFA0A7541414514500145145005A5FBB4B48BF7696800A28A2800A28A2800ED559FFD637D6ACF6AACFF00EB1BEB400DA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802D2FDDA5A45FBB4B400514514005145140076AACFFEB1BEB567B5567FF58DF5A006D1451400514514005145140051451400514514005145140051451400514514005145140051451401697EED2D22FDDA5A0028A28A0028A28A003B5567FF0058DF5AB3DAAB3FFAC6FAD00368A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00B4BF7696917EE8A5A0028A28A0028A28A002A078D8B92077A9E8A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A0041D314B4514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451401FFD9,
    attendance INT,
    beginning_date DATETIME,
    finishing_date DATETIME,
);
GO

CREATE TABLE FLOOR_(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    number_ INT NOT NULL
);
GO

CREATE TABLE GOAL(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(150) NOT NULL, 
    --FK
    id_celebration INT NOT NULL
);
GO

CREATE TABLE ACTIVITY(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    --FK
    id_area INT NOT NULL,
    id_celebration INT,
    id_attendance INT NOT NULL
);
GO

CREATE TABLE AREA(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    --ATRIBUTOS
    name_ VARCHAR(50) NOT NULL,
    area_description VARCHAR(300),
    schedule VARCHAR(30),
    --FK
    id_manager INT 
        DEFAULT 'No defined',
	id_floor INT NOT NULL
);
GO

CREATE TABLE MANAGER(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50) NOT NULL
);
GO

CREATE TABLE USER_(
    id INT 
        IDENTITY(1,1) PRIMARY KEY,
    --ATRIBUTOS
	full_name VARCHAR (50) NOT NULL,
    username VARCHAR(20) NOT NULL UNIQUE,
    address_ VARCHAR(100) NULL
        DEFAULT 'No defined',
    phone CHAR(13) 
        NOT NULL 
        UNIQUE 
        CHECK (phone LIKE '+503 [2|6|7][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'),
    picture VARBINARY(MAX)
        DEFAULT 0xFFD8FFE000104A46494600010101006000600000FFE1003A4578696600004D4D002A00000008000351100001000000010100000051110004000000010000000051120004000000010000000000000000FFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F141D1A1F1E1D1A1C1C20242E2720222C231C1C2837292C30313434341F27393D38323C2E333432FFDB0043010909090C0B0C180D0D1832211C213232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232FFC000110800E600DB03012200021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00F7BA28A298828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A293728EA45002D14DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A00751451400514514005145140055693FD637D6ACF6AACFF00EB1BEB400DA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802D2FDD14B48BF7696800A28A2800A28A2800ED559FF00D637D6ACF6AACFFEB1BEB400DA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802D2FDDA5A45FBB4B400514514005145140076AACFF00EB1BEB567B5567FF0058DF5A006D1451400514514005145140051451400514514005145140051451400514514005145140051451401697EED2D22FDDA5A0028A28A0028A28A003B5567FF58DF5AB3DAAB3FF00AC6FAD00368A28A0028A28A0028C13D01A2B9A4B36D6758D484F7D791ADBCAB1C6904BB401B73E9401D361BD0FE546D6F43F95617FC23307FD04753FFC09FF00EB51FF0008CC1FF411D4FF00F027FF00AD401BBB5BD0FE546D6F43F95617FC23307FD04753FF00C09FFEB51FF08CC1FF00411D4FFF00027FFAD401BBB5BD0FE546D6F43F95617FC23307FD04753FFC09FF00EB51FF0008CC1FF411D4FF00F027FF00AD401BBB5BD0FE54983DC1FCAB0FFE11983FE823A9FF00E04FFF005AA9EABA30D374BB8BDB7D4751F3A04DE9BE7C8C8F518A623A8A2A3B77325BC4EDF7990138F5C54948614514500145145005A5FBB4B48BF7696800A28A2800A28A2800ED559FFD637D6ACF6AACFF00EB1BEB400DA28A2800A28A2800AC4D1BFE431ADFFD7C2FFE822B6EB1346FF90C6B7FF5F0BFFA08A00DBA28A2800A28A280395D6BC61FD9DA8BDA5B5B2CA622048CEC473DC0C7F3ADCD23538F57D3A3BB8D4A672194FF00091585ADF838EA3A8BDE5B5C2446539915D49E7D456EE91A647A4E9D1DA46C5F6E4B311F789EA69E82D6E5EACAF127FC8BB7FF00F5C8D6AD657893FE45DBFF00FAE4692197ED3FE3CADFFEB92FF215354369FF001E56FF00F5C97F90A9A800A28A2800A28A2802D2FDDA5A45FBB4B400514514005145140076AACFFEB1BEB567B5567FF58DF5A006D14514005145140056268DFF00218D6FFEBE17FF004115B7585A548916A7AEC92BAA4693A966638006C1CD006DC922431349230545196627802BCEF5FF0014DC5FDD2A58C8F0DB42DB9594E19D8773EDE829BE23F123EAD21B7B62C966A78EC643EA7DBDAB9EAA4896CF4AF0E788D35887C99B6A5E20CB28E8E3FBC3FA8ADFAF198A5920952689D92443B9594F20D7A47873C471EB10F933154BC41F32F40E3D47F5149A1A66F5676AFACDAE8D6C25B8259D8E1225FBCDFE7D69359D66DF46B4F36521A46E23881E5CFF0087BD798DFDFDC6A576F7372FB9DBA0ECA3D07B5090367ACDA5E417F6C9716D20789C6411FC8FBD51F127FC8B97DFF5C8D701A1EB93E8B75B941781CFEF22CF5F71E86BB8D62EE0BFF095E5CDB482489E13823F507D08A2D60BDD1AD69FF1E56FFF005C97F90A9AA1B4FF008F383FEB92FF002A9A90C28A28A0028A28A00B4BF7696917EED2D0014514500145145001DAAB3FFAC6FAD59ED559FF00D637D6801B45145001451450015E63E23BA99757D46D55CAC2F307751FC44018CD7A7572BAB7837FB475296EE2BD1179BCB2326707DA9A13380A2BB1FF0084025FFA08C7FF007E8FF8D1FF000804DFF4118FFEFD1FF1AABA1599C753E296482649A1764910E5594F20D75DFF000804DFF4118FFEFD1FF1A3FE1009BFE8231FFDFA3FE345D0599CB5F5F5CEA576D7377299242319EC07A01D8557AEC7FE1009BFE8231FFDFA3FE347FC20137FD0463FFBF47FC68BA0B338EAB36FA85C5ADADCDB23FEE2E136C887A7D7EB5D47FC20137FD0463FFBF47FC6957C00FB86FD4536E79DB11CE3F3A2E82CCEC6CFFE3CADFF00EB92FF0021535363458E3545FBAA028CFA0A7541414514500145145005A5FBB4B48BF7696800A28A2800A28A2800ED559FFD637D6ACF6AACFF00EB1BEB400DA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802D2FDDA5A45FBB4B400514514005145140076AACFFEB1BEB567B5567FF58DF5A006D1451400514514005145140051451400514514005145140051451400514514005145140051451401697EED2D22FDDA5A0028A28A0028A28A003B5567FF0058DF5AB3DAAB3FFAC6FAD00368A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00B4BF7696917EE8A5A0028A28A0028A28A002A078D8B92077A9E8A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A0041D314B4514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451401FFD9,
    email VARCHAR(50) UNIQUE,
    password VARCHAR(256),
    --FK
    id_occupancy INT NOT NULL,
    id_institution INT NOT NULL,
    id_role INT NOT NULL
);
GO

CREATE TABLE OCCUPANCY(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50) -- NOT NULL UNIQUE
);
GO

CREATE TABLE ROLE_(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50)
);
GO

CREATE TABLE INSTITUTION(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50) NOT NULL
);
GO

CREATE TABLE ATTENDANCE(
    id INT 
        IDENTITY(1,1) PRIMARY KEY,
    --ATRIBUTOS
    entrance_date DATETIME,
    --FK
    id_user INT NOT NULL,
);
GO

CREATE TABLE LOAN_BOOKING(
    id INT 
        IDENTITY(1,1) PRIMARY KEY,
    --ATRIBUTOS
    timestamp DATETIME,
    expected_loan_timestamp DATETIME,
    expected_return_timestamp DATETIME,
    loan_timestamp DATETIME,
    return_timestamp DATETIME,
    --FK
    id_user INT NOT NULL,
    id_copy INT NOT NULL,
);
GO

CREATE TABLE COPY_(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    --ATRIBUTOS
    name_ VARCHAR(100) NOT NULL,
    picture VARBINARY(MAX)
        DEFAULT 0xFFD8FFE000104A46494600010101006000600000FFE1003A4578696600004D4D002A00000008000351100001000000010100000051110004000000010000000051120004000000010000000000000000FFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F141D1A1F1E1D1A1C1C20242E2720222C231C1C2837292C30313434341F27393D38323C2E333432FFDB0043010909090C0B0C180D0D1832211C213232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232FFC000110800E600DB03012200021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00F7BA28A298828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A293728EA45002D14DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A007514DDEBFDE146F5FEF0A00751451400514514005145140055693FD637D6ACF6AACFF00EB1BEB400DA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802D2FDD14B48BF7696800A28A2800A28A2800ED559FF00D637D6ACF6AACFFEB1BEB400DA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802D2FDDA5A45FBB4B400514514005145140076AACFF00EB1BEB567B5567FF0058DF5A006D1451400514514005145140051451400514514005145140051451400514514005145140051451401697EED2D22FDDA5A0028A28A0028A28A003B5567FF58DF5AB3DAAB3FF00AC6FAD00368A28A0028A28A0028C13D01A2B9A4B36D6758D484F7D791ADBCAB1C6904BB401B73E9401D361BD0FE546D6F43F95617FC23307FD04753FFC09FF00EB51FF0008CC1FF411D4FF00F027FF00AD401BBB5BD0FE546D6F43F95617FC23307FD04753FF00C09FFEB51FF08CC1FF00411D4FFF00027FFAD401BBB5BD0FE546D6F43F95617FC23307FD04753FFC09FF00EB51FF0008CC1FF411D4FF00F027FF00AD401BBB5BD0FE54983DC1FCAB0FFE11983FE823A9FF00E04FFF005AA9EABA30D374BB8BDB7D4751F3A04DE9BE7C8C8F518A623A8A2A3B77325BC4EDF7990138F5C54948614514500145145005A5FBB4B48BF7696800A28A2800A28A2800ED559FFD637D6ACF6AACFF00EB1BEB400DA28A2800A28A2800AC4D1BFE431ADFFD7C2FFE822B6EB1346FF90C6B7FF5F0BFFA08A00DBA28A2800A28A280395D6BC61FD9DA8BDA5B5B2CA622048CEC473DC0C7F3ADCD23538F57D3A3BB8D4A672194FF00091585ADF838EA3A8BDE5B5C2446539915D49E7D456EE91A647A4E9D1DA46C5F6E4B311F789EA69E82D6E5EACAF127FC8BB7FF00F5C8D6AD657893FE45DBFF00FAE4692197ED3FE3CADFFEB92FF215354369FF001E56FF00F5C97F90A9A800A28A2800A28A2802D2FDDA5A45FBB4B400514514005145140076AACFFEB1BEB567B5567FF58DF5A006D14514005145140056268DFF00218D6FFEBE17FF004115B7585A548916A7AEC92BAA4693A966638006C1CD006DC922431349230545196627802BCEF5FF0014DC5FDD2A58C8F0DB42DB9594E19D8773EDE829BE23F123EAD21B7B62C966A78EC643EA7DBDAB9EAA4896CF4AF0E788D35887C99B6A5E20CB28E8E3FBC3FA8ADFAF198A5920952689D92443B9594F20D7A47873C471EB10F933154BC41F32F40E3D47F5149A1A66F5676AFACDAE8D6C25B8259D8E1225FBCDFE7D69359D66DF46B4F36521A46E23881E5CFF0087BD798DFDFDC6A576F7372FB9DBA0ECA3D07B5090367ACDA5E417F6C9716D20789C6411FC8FBD51F127FC8B97DFF5C8D701A1EB93E8B75B941781CFEF22CF5F71E86BB8D62EE0BFF095E5CDB482489E13823F507D08A2D60BDD1AD69FF1E56FFF005C97F90A9AA1B4FF008F383FEB92FF002A9A90C28A28A0028A28A00B4BF7696917EED2D0014514500145145001DAAB3FFAC6FAD59ED559FF00D637D6801B45145001451450015E63E23BA99757D46D55CAC2F307751FC44018CD7A7572BAB7837FB475296EE2BD1179BCB2326707DA9A13380A2BB1FF0084025FFA08C7FF007E8FF8D1FF000804DFF4118FFEFD1FF1AABA1599C753E296482649A1764910E5594F20D75DFF000804DFF4118FFEFD1FF1A3FE1009BFE8231FFDFA3FE345D0599CB5F5F5CEA576D7377299242319EC07A01D8557AEC7FE1009BFE8231FFDFA3FE347FC20137FD0463FFBF47FC68BA0B338EAB36FA85C5ADADCDB23FEE2E136C887A7D7EB5D47FC20137FD0463FFBF47FC6957C00FB86FD4536E79DB11CE3F3A2E82CCEC6CFFE3CADFF00EB92FF0021535363458E3545FBAA028CFA0A7541414514500145145005A5FBB4B48BF7696800A28A2800A28A2800ED559FFD637D6ACF6AACFF00EB1BEB400DA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2802D2FDDA5A45FBB4B400514514005145140076AACFFEB1BEB567B5567FF58DF5A006D1451400514514005145140051451400514514005145140051451400514514005145140051451401697EED2D22FDDA5A0028A28A0028A28A003B5567FF0058DF5AB3DAAB3FFAC6FAD00368A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00B4BF7696917EE8A5A0028A28A0028A28A002A078D8B92077A9E8A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A00ADE5BFF00768F2DFF00BB5668A0041D314B4514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451401FFD9,
    release_date DATETIME,
    --FK
    id_collection INT NOT NULL,
    id_language INT,
    id_format INT,
	id_editorial INT
);
GO

CREATE TABLE EDITORIAL(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50) NOT NULL
);
GO

CREATE TABLE LANGUAGE_(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50) NOT NULL
);
GO

CREATE TABLE FORMAT_(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50) NOT NULL
);
GO

CREATE TABLE AUTHOR(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50) NOT NULL,
    --FK
    id_copy INT NOT NULL
);
GO

CREATE TABLE WORDS_LIST(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    word VARCHAR(50) NOT NULL,
    --FK
    id_copy INT NOT NULL
);
GO

CREATE TABLE LABEL_(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    label_code VARCHAR(50) NOT NULL 
        DEFAULT 'None',
    --FK
    id_copy INT NOT NULL,
	id_label_type INT NOT NULL
);
GO

CREATE TABLE LABEL_TYPE(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(4) NOT NULL
);
GO


CREATE TABLE COLLECTION_(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(150) NOT NULL,
    --FK
    id_type INT,
    id_genre INT
);
GO

CREATE TABLE TYPE_(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50) NOT NULL
);
GO

CREATE TABLE GENRE(
    id INT
        IDENTITY(1,1) PRIMARY KEY,
    name_ VARCHAR(50) NOT NULL
);
GO
--******************************************************* FOREIGN KEYS CREATION ******************************************************
--COLLECTION_ TABLE
ALTER TABLE COLLECTION_ ADD CONSTRAINT fk_collection_genre
	FOREIGN KEY(id_genre) REFERENCES GENRE(id); 
GO    
ALTER TABLE COLLECTION_ ADD CONSTRAINT fk_collection_type
	FOREIGN KEY(id_type) REFERENCES TYPE_(id); 
GO
-- WORDS_LIST TABLE
ALTER TABLE WORDS_LIST ADD CONSTRAINT fk_copy_list
	FOREIGN KEY(id_copy) REFERENCES COPY_(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO
-- AUTHOR TABLE
ALTER TABLE AUTHOR ADD CONSTRAINT fk_copy_author
	FOREIGN KEY(id_copy) REFERENCES COPY_(id); 
GO
-- COPY_ TABLE
ALTER TABLE COPY_ ADD CONSTRAINT fk_collection_copy
	FOREIGN KEY(id_collection) REFERENCES COLLECTION_(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO
ALTER TABLE COPY_ ADD CONSTRAINT fk_copy_language
	FOREIGN KEY(id_language) REFERENCES LANGUAGE_(id);
GO
ALTER TABLE COPY_ ADD CONSTRAINT fk_copy_format
	FOREIGN KEY(id_format) REFERENCES FORMAT_(id);
GO
ALTER TABLE COPY_ ADD CONSTRAINT fk_copy_editorial
	FOREIGN KEY(id_editorial) REFERENCES EDITORIAL(id);
GO
-- USER_ TABLE
ALTER TABLE USER_ ADD CONSTRAINT fk_user_intitution
	FOREIGN KEY(id_institution) REFERENCES INSTITUTION(id);
GO
ALTER TABLE USER_ ADD CONSTRAINT fk_user_occupancy
	FOREIGN KEY(id_occupancy) REFERENCES OCCUPANCY(id);
GO
ALTER TABLE USER_ ADD CONSTRAINT fk_user_role
	FOREIGN KEY(id_role) REFERENCES ROLE_(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;;
GO
-- AREA TABLE
ALTER TABLE AREA ADD CONSTRAINT fk_area_manager
	FOREIGN KEY(id_manager) REFERENCES MANAGER(id);
GO
ALTER TABLE AREA ADD CONSTRAINT fk_area_floor
	FOREIGN KEY(id_floor) REFERENCES FLOOR_(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO
-- GOAL TABLE
ALTER TABLE GOAL ADD CONSTRAINT fk_goal_event
	FOREIGN KEY(id_celebration) REFERENCES CELEBRATION(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO
--******************************************************* CROSS TABLES ******************************************************
-- LABEL_ TABLE
ALTER TABLE LABEL_ ADD CONSTRAINT fk_copy_label
	FOREIGN KEY(id_copy) REFERENCES COPY_(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO
ALTER TABLE LABEL_ ADD CONSTRAINT fk_type_label
	FOREIGN KEY(id_label_type) REFERENCES LABEL_TYPE(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO
-- LOAN_BOOKING TABLE
ALTER TABLE LOAN_BOOKING ADD CONSTRAINT fk_user_lxb
    FOREIGN KEY(id_user) REFERENCES USER_(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO
ALTER TABLE LOAN_BOOKING ADD CONSTRAINT fk_copy_lxb
    FOREIGN KEY(id_copy) REFERENCES COPY_(id)
	ON DELETE NO ACTION
    ON UPDATE NO ACTION;
GO
-- ACTIVITY TABLE
ALTER TABLE ACTIVITY ADD CONSTRAINT fk_activity_area
    FOREIGN KEY(id_area) REFERENCES AREA(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO
ALTER TABLE ACTIVITY ADD CONSTRAINT fk_event_activity
    FOREIGN KEY(id_celebration) REFERENCES CELEBRATION(id);
GO 
ALTER TABLE ACTIVITY ADD CONSTRAINT fk_activity_attendance
    FOREIGN KEY(id_attendance) REFERENCES ATTENDANCE(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO 
-- ATTENDANCE TABLE
ALTER TABLE ATTENDANCE ADD CONSTRAINT fk_attendance_user
    FOREIGN KEY(id_user) REFERENCES USER_(id)
	ON DELETE CASCADE
    ON UPDATE CASCADE;
GO
USE master;